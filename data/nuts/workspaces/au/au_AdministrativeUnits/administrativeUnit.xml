<?xml version="1.0" encoding="UTF-8"?>
<as:AppSchemaDataAccess xmlns:as="http://www.geotools.org/app-schema"
    xmlns:ogc="http://www.opengis.net/ogc" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.geotools.org/app-schema AppSchemaDataAccess.xsd">
    <namespaces>
        <Namespace>
            <prefix>au</prefix>
            <uri>urn:x-inspire:specification:gmlas:AdministrativeUnits:3.0</uri>
        </Namespace>
        <Namespace>
            <prefix>gml</prefix>
            <uri>http://www.opengis.net/gml/3.2</uri>
        </Namespace>
        <Namespace>
            <prefix>xlink</prefix>
                <uri>http://www.w3.org/1999/xlink</uri>
            </Namespace>
        <Namespace>
            <prefix>base</prefix>
            <uri>urn:x-inspire:specification:gmlas:BaseTypes:3.2</uri>
        </Namespace>
        <Namespace>
            <prefix>gmd</prefix>
            <uri>http://www.isotc211.org/2005/gmd</uri>
        </Namespace>
        <Namespace>
            <prefix>gn</prefix>
            <uri>urn:x-inspire:specification:gmlas:GeographicalNames:3.0</uri>
        </Namespace>
        <Namespace>
            <prefix>stat</prefix>
            <uri>urn:x-inspire:specification:gmlas:StatisticalUnits:0.0</uri>
        </Namespace>
    </namespaces>
    <sourceDataStores>
        <DataStore>
            <id>ign_postgis_datastore</id>
            <parameters>
              <Parameter>
                  <name>namespace</name>
                  <value>urn:x-inspire:specification:gmlas:AdministrativeUnits:3.0</value>
              </Parameter>
              <Parameter>
                  <name>loose bbox</name>
                  <value>true</value>
              </Parameter>
              <Parameter>
                  <name>user</name>
                  <value>ign</value>
              </Parameter>
              <Parameter>
                  <name>passwd</name>
                  <value>ign</value>
              </Parameter>
              <Parameter>
                  <name>wkb enabled</name>
                  <value>true</value>
              </Parameter>
              <Parameter>
                  <name>host</name>
                  <value>localhost</value>
              </Parameter>
              <Parameter>
                  <name>port</name>
                  <value>5432</value>
              </Parameter>
              <Parameter>
                  <name>database</name>
                  <value>ign</value>
              </Parameter>
              <Parameter>
                  <name>dbtype</name>
                  <value>postgisng</value>
              </Parameter>
              <Parameter>
                  <name>Estimated extends</name>
                  <value>true</value>
              </Parameter>
            </parameters>
        </DataStore>
    </sourceDataStores>
    <includedTypes>
    	<Include>
    		SpellingOfName.xml
    	</Include>
    </includedTypes>
    <targetTypes>
        <FeatureType>
            <schemaUri>AdministrativeUnits.xsd</schemaUri>
        </FeatureType>
    </targetTypes>
    <typeMappings>
        <FeatureTypeMapping>
            <sourceDataStore>ign_postgis_datastore</sourceDataStore>
            <sourceType>administrativeunit</sourceType>
            <targetElement>au:AdministrativeUnit</targetElement>
            <groupBy />
            <attributeMappings>
                <AttributeMapping>
                    <targetAttribute>au:AdministrativeUnit</targetAttribute>
                    <idExpression>
                        <OCQL>strTrim(inspireid)</OCQL>
                    </idExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:geometry</targetAttribute>
                    <idExpression>
                        <OCQL>strConcat('unit_geometry.', strTrim(inspireid))</OCQL>
                    </idExpression>
                    <sourceExpression>
                        <OCQL>geometry</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:nationalCode</targetAttribute>
                    <sourceExpression>
                        <OCQL>strTrim(nationalcode)</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:inspireId/base:Identifier/base:localId</targetAttribute>
                    <sourceExpression>
                        <OCQL>strTrim(inspireid)</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:nationalLevel</targetAttribute>
                    <sourceExpression>
                        <OCQL>nationallevel</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:nationalLevelName/gmd:LocalisedCharacterString</targetAttribute>
                    <sourceExpression>
                        <OCQL>nationallevelname</OCQL>
                    </sourceExpression>
                    <ClientProperty>
                        <name>locale</name>
                        <value>'#FR'</value>
                    </ClientProperty> 
                </AttributeMapping>
            <AttributeMapping>
                    <targetAttribute>au:country/gmd:Country</targetAttribute>
                    <sourceExpression>
                        <OCQL>strTrim(country)</OCQL>
                    </sourceExpression>
                    <ClientProperty>
                        <name>codeList</name>
                        <value>'http://www.isotc211.org/2005/resources/codeList.xml#Country'</value>
                    </ClientProperty> 
                    <ClientProperty>
                        <name>codeListValue</name>
                        <value>strTrim(country)</value>
                    </ClientProperty> 
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:name/gn:GeographicalName/gn:spelling</targetAttribute>
                    <sourceExpression>
                        <OCQL>strTrim(name)</OCQL>
                        <linkElement>gn:SpellingOfName</linkElement>
                        <linkField>FEATURE_LINK</linkField>
                    </sourceExpression>
                </AttributeMapping>
<!-- TODO  This is a complex type leaving it until later
                <AttributeMapping>
                    <targetAttribute>au:residenceOfAuthority</targetAttribute>
                    <sourceExpression>
                        <OCQL>residenceOfAuthority</OCQL>
                    </sourceExpression>
                </AttributeMapping> -->
                <AttributeMapping>
                    <targetAttribute>au:beginLifespanVersion</targetAttribute>
                    <sourceExpression>
                        <OCQL>beginlifespanversion</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>au:endLifespanVersion</targetAttribute>
                    <sourceExpression>
                        <OCQL>endlifespanversion</OCQL>
                    </sourceExpression>
                </AttributeMapping>
<!-- TODO  Data does not have any nuts values all are empty
                <AttributeMapping>
                    <targetAttribute>au:NUTS</targetAttribute>
                    <sourceExpression>
                        <OCQL>nuts</OCQL>
                    </sourceExpression>
                </AttributeMapping> -->
				<AttributeMapping>
					<targetAttribute>au:boundary</targetAttribute>
					<sourceExpression>
						<OCQL>strTrim(boundary)</OCQL>
						<linkElement>au:AdministrativeBoundary</linkElement>
						<linkField>au:inspireId/base:Identifier/base:localId</linkField>
					</sourceExpression>
					<isMultiple>true</isMultiple>
					<ClientProperty>
						<name>xlink:href</name>
						<value>strConcat('urn:x-inspire:specification:gmlas:AdministrativeBoundary:3.0:', strTrim(inspireid))</value>
					</ClientProperty>
				</AttributeMapping>
			</attributeMappings>
		</FeatureTypeMapping>
		<FeatureTypeMapping>
			<sourceDataStore>ign_postgis_datastore</sourceDataStore>
			<sourceType>administrativeboundary</sourceType>
			<targetElement>au:AdministrativeBoundary</targetElement>
			
			<attributeMappings>
				<AttributeMapping>
					<targetAttribute>au:AdministrativeBoundary</targetAttribute>
					<idExpression>
						<OCQL>strTrim(inspireid)</OCQL>
					</idExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:geometry</targetAttribute>
					<idExpression>
						<OCQL>strConcat('boundary_geometry.', strTrim(inspireid))</OCQL>
					</idExpression>
					<sourceExpression>
						<OCQL>geometry</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
                    <targetAttribute>au:inspireId/base:Identifier/base:localId</targetAttribute>
                    <sourceExpression>
                        <OCQL>strTrim(inspireid)</OCQL>
                    </sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
                    <targetAttribute>au:country/gmd:Country</targetAttribute>
                    <sourceExpression>
                        <OCQL>country</OCQL>
                    </sourceExpression>
                    <ClientProperty>
                        <name>codeList</name>
                        <value>'#Country'</value>
                    </ClientProperty> 
<!-- TODO Need a why to calculate the codelistvalue.  a table or external properties files
                    <ClientProperty>
                        <name>codeListValue</name>
                        <OCQL>countrycode</OCQL>
                    </ClientProperty> -->
                </AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:nationalLevel</targetAttribute>
					<sourceExpression>
						<OCQL>nationallevel</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:legalStatus</targetAttribute>
					<sourceExpression>
						<OCQL>legalstatus</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:technicalStatus</targetAttribute>
					<sourceExpression>
						<OCQL>technicalstatus</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:beginLifespanVersion</targetAttribute>
					<sourceExpression>
						<OCQL>beginlifespanversion</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:endLifespanVersion</targetAttribute>
					<sourceExpression>
						<OCQL>endlifespanversion</OCQL>
					</sourceExpression>
				</AttributeMapping>
				<AttributeMapping>
					<targetAttribute>au:admUnit</targetAttribute>
					<sourceExpression>
						<OCQL>strTrim(admunit)</OCQL>
						<linkElement>au:AdministrativeUnit</linkElement>
						<linkField>au:inspireId/base:Identifier/base:localId</linkField>
					</sourceExpression>
					<isMultiple>true</isMultiple>
					<ClientProperty>
						<name>xlink:href</name>
						<value>strConcat('urn:x-inspire:specification:gmlas:AdministrativeUnits:3.0:', strTrim(inspireid))</value>
					</ClientProperty>
				</AttributeMapping>
			</attributeMappings>
		</FeatureTypeMapping>
	</typeMappings>
</as:AppSchemaDataAccess>
